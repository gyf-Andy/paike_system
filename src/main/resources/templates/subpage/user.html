<!doctype html>
<!--è§£å†³idea thymeleaf è¡¨è¾¾å¼æ¨¡æ¿æŠ¥çº¢æ³¢æµªçº¿-->
<!--suppress ALL -->
<html xmlns:th="http://www.thymeleaf.org" >
<head>
    <meta charset="utf-8">
    <title>ç®¡ç†å‘˜</title>
<!--    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" crossorigin="anonymous">-->
<!--    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-LCPyFKQyML7mqtS+4XytolfqyqSlcbB3bvDuH9vX2sdQMxRonb/M3b9EmhCNNNrV" crossorigin="anonymous"></script>-->

    <script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.js"></script>
    <link rel="stylesheet" href="/bootstrap-4.6.0-dist/css/bootstrap.min.css">
    <script src="/bootstrap-4.6.0-dist/js/bootstrap.min.js"></script>
    <link href="/css/common.css" rel="stylesheet">

</head>

<body>

<div id="main" >
    <header >
        <h2>ç®¡ç†å‘˜ï¼š<span class="text-primary"><span shiro:principal/></span></h2>
        <h5>è¯·é€‰æ‹©ä½ çš„æ“ä½œï¼šğŸ—‘</h5>
        <div id="buttonBox" style="text-align: center">
            <!-- Button trigger modal -->
            <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal">
                æ·»åŠ 
            </button>
            
            <a href="/test/toHomePage.action">
                <button type="button" class="btn btn-primary">è¿”å›</button>
            </a>
        </div>
    </header>


    <table class="table table-hover mt-5">
        <thead>
        <tr>
            <th scope="col">#</th>
            <th scope="col">è´¦å·</th>
            <th scope="col">å¯†ç </th>
            <th scope="col">å§“å</th>
            <th scope="col">æ“ä½œ</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="admin : ${pageInfo.list}">
            <th scope="row" th:text="${admin.getId()}"></th>
            <td th:text="${admin.getAccount()}"></td>
            <td th:text="${admin.getPassword()}"></td>
            <td th:text="${admin.getName()}"></td>
            <td>
                <button type="button" class="btn btn-light" th:onclick="deleteAdmin([[${admin.getId()}]])">åˆ é™¤</button>
<!--                <button type="button" class="btn btn-light" data-toggle="modal" data-target="#updateModal">ä¿®æ”¹</button>-->
            </td>
        </tr>
        </tbody>
    </table>

    <div class="w-100">
        <nav aria-label="Page navigation example" style="margin-left: 38%">
            <ul class="pagination center">
                <li class="page-item">
                    <a class="page-link" th:href="@{/test/getAdminInfo.action(pageNum=${pageInfo.hasPreviousPage}?${pageInfo.prePage}:1)}" aria-label="Previous">
                        <span aria-hidden="true">&laquo;</span>
                    </a>
                </li>
                <span th:each="pageNum : ${pageInfo.navigatepageNums}">
                     <li class="page-item"><a class="page-link" th:href="'/test/getAdminInfo.action?pageNum='+${pageNum}" th:text="${pageNum}">1</a></li>
                </span>
                <li class="page-item">
                    <a class="page-link" th:href="@{/test/getAdminInfo.action(pageNum=${pageInfo.hasNextPage}?${pageInfo.nextPage}:${pageInfo.pages})}" aria-label="Next">
                        <span aria-hidden="true">&raquo;</span>
                    </a>
                </li>
            </ul>
        </nav>
    </div>
</div>

<!-- æ·»åŠ æ¨¡æ€æ¡† -->
<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">æ·»åŠ ç®¡ç†å‘˜</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="form">
                    <div class="form-group">
                        <label for="formGroupExampleInput">è´¦ å·</label>
                        <input type="text" class="form-control" name="account" id="formGroupExampleInput" placeholder="è¯·è¾“å…¥è´¦å·">
                    </div>
                    <div class="form-group">
                        <label for="formGroupExampleInput2">å¯† ç </label>
                        <input type="password" class="form-control" name="password" id="formGroupExampleInput2" placeholder="è¯·è¾“å…¥å¯†ç ">
                    </div>
                    <div class="form-group">
                        <label for="formGroupExampleInput2">å§“å</label>
                        <input type="text" class="form-control" name="name" id="formGroupExampleInput3" placeholder="è¯·è¾“å…¥å§“å">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">å…³é—­</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" onclick="add()">ç¡®è®¤</button>
            </div>
        </div>
    </div>
</div>


<script type="text/javascript">


    function add(){
        var name=$('input[name="account"]').val();
        if (name==''){
            alert("è´¦å·ä¸èƒ½ä¸ºç©ºï¼");
        }else{
            $.ajax({
                url: '/test/addAdmin.action',
                type: 'post',
                data: $('#form').serialize(),
                success: function(msg){
                    // alert(msg.code);
                    //code==200è¯æ˜ç™»é™†æˆåŠŸ
                    alert(msg.msg);
                },
                error: function(){
                    alert("è®¿é—®å‡ºé”™ï¼");
                }
            });
        }
    }

    function deleteAdmin(id){

        alert(id)
        if (confirm("æ˜¯å¦è¦åˆ é™¤")){
            $.ajax({
                url: '/test/deleteAdmin.action',
                data: {
                    id:id
                },
                success:function(msg){
                    if (msg.code==200){
                        alert("åˆ é™¤æˆåŠŸï¼");
                        location.reload(true);
                    }
                },
                error:function(){
                    alert("è¯·æ±‚å¤±è´¥ï¼");
                }

            });
        }

    }


</script>

</body>
</html>
